{
  "hash": "6b0d59e6f2830039435bebc956ad2694",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"One-Way ANOVA vignette\"\nauthor: \"Author: Antdrew D. Nguyen\"\ndate: \"Date: 2017-06-01\"\ntoc: TRUE\n---\n\n# Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(plyr)\nlibrary(tidyr)\n```\n:::\n\n\n# Reviewing Analysis of Variance (ANOVA)\n\nI'll be following Chapter 10 of *A Primer of Ecological Statistics* by Gotelli and Ellison\n\nKey Concepts:\n\nANOVA aims to determine differences in a continuous variable between 2 or more groups.\n\nANOVA bulit on partitioning on the concept of paritioning of the sum of squares ($SS_{total}$). How do we calculate this?\n\nThe total sum of squares of the data is the sum of squared deviations of each observation ($Y_i$) from the grand mean ($\\bar{Y}$). There are $i$ = 1 to $a$ treatment levels and $j$ = 1 to $n$ replicates per treatment.\n\n**recap**:\n\n-   $i$ refers to the treatment levels\n    -   it looks like $a$ represents the number of different treatments\\\n-   $j$ refers to each observations, with $n$ being the number of replicates\n\n$$ SS_{total} = \\sum_{i=1}^a\\sum_{j=1}^n (Y_{ij}-\\bar{Y})^2$$\n\nThe total sum of squares is the deviation of each observation from the grand mean.\n\n$SS_{total}$ can then be partitioned into different components, mainly **among and within groups**.\n\n$$SS_{total} = SS_{among} + SS_{within}$$ So for the *among* group SS:\n\n$$ SS_{among} = \\sum_{i=1}^a\\sum_{j=1}^n (\\bar{Y}_{i}-\\bar{Y})^2$$ So for the *within* group SS:\n\n$$ SS_{within} = \\sum_{i=1}^a\\sum_{j=1}^n (Y_{ij}-\\bar{Y}_i)^2$$\n\n**Bringing it all together**:\n\n$$ \\sum_{i=1}^a\\sum_{j=1}^n (Y_{ij}-\\bar{Y})^2 =  \\sum_{i=1}^a\\sum_{j=1}^n (\\bar{Y}_{i}-\\bar{Y})^2 +  \\sum_{i=1}^a\\sum_{j=1}^n (Y_{ij}-\\bar{Y}_i)^2$$\n\n## Enter data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#data, \n# a = 3, 3 treatments\n# n = 4, 4 reps\nn=4\nunman<-c(10,12,12,13)\ncontrol<-c(9,11,11,12)\ntreat<-c(12,13,15,16)\n\nwide.dat<-data.frame(unman,control,treat);wide.dat\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  unman control treat\n1    10       9    12\n2    12      11    13\n3    12      11    15\n4    13      12    16\n```\n\n\n:::\n\n```{.r .cell-code}\nlong.dat<-gather(wide.dat,treatment,measure,unman:treat);long.dat\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   treatment measure\n1      unman      10\n2      unman      12\n3      unman      12\n4      unman      13\n5    control       9\n6    control      11\n7    control      11\n8    control      12\n9      treat      12\n10     treat      13\n11     treat      15\n12     treat      16\n```\n\n\n:::\n\n```{.r .cell-code}\n#global mean\ngrandmean<-round(mean(c(unman,control,treat)),2);grandmean\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 12.17\n```\n\n\n:::\n:::\n\n\n## $SS_{total}$ calculations\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum((long.dat$measure-grandmean)^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 41.6668\n```\n\n\n:::\n:::\n\n\n## $SS_{among}$ calculations\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## calculating 1 case\n\n(mean(unman)-grandmean)^2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1764\n```\n\n\n:::\n\n```{.r .cell-code}\n### making a whole function \n#with ddply\nssa<-function(n=n,vec=c(1,3,3),grandmean=grandmean){\n  SSa<-(mean(vec)-grandmean)^2\n  SSa\n}\nssa(vec=unman,n=n,grandmean=grandmean) # verify function\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1764\n```\n\n\n:::\n\n```{.r .cell-code}\n## executing function\nssam<-ddply(long.dat,.(treatment),summarize,ssamong=ssa(vec=measure,n=n,grandmean=grandmean));ssam\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  treatment ssamong\n1   control  2.0164\n2     treat  3.3489\n3     unman  0.1764\n```\n\n\n:::\n\n```{.r .cell-code}\nSSAM<-n*sum(ssam$ssamong);SSAM\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 22.1668\n```\n\n\n:::\n\n```{.r .cell-code}\n# for a balanced design!\n```\n:::\n\n\n## $SS_{within}$ calculations\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## calculating 1 case\nsum((unman-mean(unman))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4.75\n```\n\n\n:::\n\n```{.r .cell-code}\n### making a whole function \n#with ddply\nsswi<-function(x){\n  SSwithin<-sum((x-mean(x))^2)\n  SSwithin\n}\nsswi(unman) # verify function\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 4.75\n```\n\n\n:::\n\n```{.r .cell-code}\nSSwi<-ddply(long.dat,.(treatment),summarize,sswi=sswi(measure));SSwi\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  treatment  sswi\n1   control  4.75\n2     treat 10.00\n3     unman  4.75\n```\n\n\n:::\n\n```{.r .cell-code}\nsumwithin<-sum(SSwi$sswi);sumwithin\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 19.5\n```\n\n\n:::\n:::\n\n\n# Assumptions of ANOVAs\n\n1.  Samples are indepednent and identically distributed.\n2.  Variances are homogeneous among groups\n    -   variance within each group approx to variance within other groups\\\n3.  Residuals are normally distributed\\\n4.  Samples are classified correctly\\\n5.  Maine effects are additive\n\n# Hypothesis testing\n\nDefinitions:\n\n-   $Y_{ij}$: replicated $j$ associated with treatment level $i$\\\n-   $\\mu$ is the *true* grand mean or average\\\n-   $A_i$ is the additive linear component associated with level $i$ of treatment $A$.\n    -   There is a different coefficient $A_i$ associated with each treatment level ($i$).\\\n    -   positive coefficients mean that the treatment level has a higher value than grand mean\n\nAlternative Hypothesis, $H_a$: $Y_{ij} = \\mu + A_i + \\epsilon_{ij}$\n\nNull Hypothesis, $H_o$: $Y_{ij} = \\mu + \\epsilon_{ij}$\n\n# Verify with aov() function\n\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::kable(round(summary(aov(measure~treatment,data=long.dat))[[1]],2))\n```\n\n::: {.cell-output-display}\n\n\n|          | Df| Sum Sq| Mean Sq| F value| Pr(>F)|\n|:---------|--:|------:|-------:|-------:|------:|\n|treatment |  2|  22.17|   11.08|    5.12|   0.03|\n|Residuals |  9|  19.50|    2.17|      NA|     NA|\n\n\n:::\n:::\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}