{
  "hash": "0147ea6b09551cc9182f1e783ab1f166",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lab1: Bayesian inference with beta priors, Jingchen Hu\"\nformat: html\ntoc: true\neditor: visual\neditor_options: \n  chunk_output_type: console\n---\n\n# Intro\n\nThis is a lab by a professor, Jingchen Hu, which goes over Bayesian inference with beta priors. \n\n# Load libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ProbBayes)\n```\n:::\n\n\n# Posterior predictive checking\n\n\n::: {.cell}\n\n```{.r .cell-code}\nS<-10000 # number of simulations\na<-3.06 # a in beta(a,b)\nb<-2.56 # b in beta(a,b)\nn<-20 # number of trials\ny<-12 # number of successes \n\nnewy=as.data.frame(rep(NA,S))\nnames(newy)=c(\"y\")\n\nset.seed(123)\nfor (s in 1:S){\n  pred_p_sim<-rbeta(1, a+y, b+n-y) # step 1 ; get posterior param\n  pred_y_sim<-rbinom(1,n,pred_p_sim) # step 2; based on param, predict outcome-> # of successes\n  newy[s,]=pred_y_sim\n}\nknitr::kable(head(newy))\n```\n\n::: {.cell-output-display}\n\n\n|  y|\n|--:|\n| 14|\n| 13|\n|  8|\n| 12|\n| 14|\n|  5|\n\n\n:::\n\n```{.r .cell-code}\n#how i would write the simluation\n\ndat<-tibble(pred_p=rbeta(S,a+y,b+n-y))|>\n  rowwise()|>\n  mutate(pred_y=rbinom(1,n,pred_p))\n\nsum(dat$pred_y>=5&dat$pred_y<=15)/S\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.8943\n```\n\n\n:::\n\n```{.r .cell-code}\n#dat$pred_y<-rbinom(1000,n,dat$pred_p)\nggplot(data=dat,aes(pred_y))+geom_density()+scale_x_continuous(breaks=seq(0,20,1),labels=seq(0,20,1))\n```\n\n::: {.cell-output-display}\n![](13_Bayesian_inference_Beta_priors_JingchenHu_lab1_files/figure-html/lab-1.png){width=672}\n:::\n:::\n\n\n# Let's try to simulate a situation with mismatched prior with the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbeta_draw(c(3.06,2.56)) #prior fromp revious section \n```\n\n::: {.cell-output-display}\n![](13_Bayesian_inference_Beta_priors_JingchenHu_lab1_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nbeta_draw(c(0.5,5)) #this looks liek a good prior to mess up the data \n```\n\n::: {.cell-output-display}\n![](13_Bayesian_inference_Beta_priors_JingchenHu_lab1_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\ns<-10000\nn<-20 # trials\ny<-12 #successes\na<-.5\nb<-5\n\ndat2<-tibble(pred_p=rbeta(S,a+y,b+n-y))|>\n  rowwise()|>\n  mutate(pred_y=rbinom(1,n,pred_p))\n\n# model check : how often pr(y > ypred|y)\nsum(y>dat2$pred_y)/S # how often collected data above posterior prediction\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.7158\n```\n\n\n:::\n\n```{.r .cell-code}\n1-sum(y>dat2$pred_y)/S #how often collected data below posterior prediction\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.2842\n```\n\n\n:::\n\n```{.r .cell-code}\n#draw posterior\nbeta_prior_post(c(.5,5),c(a+y,b+n-y))\n```\n\n::: {.cell-output-display}\n![](13_Bayesian_inference_Beta_priors_JingchenHu_lab1_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n:::\n\n\n# Session info\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbeta_draw(c(.3,.7)) \n```\n\n::: {.cell-output-display}\n![](13_Bayesian_inference_Beta_priors_JingchenHu_lab1_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nR version 4.5.0 (2025-04-11 ucrt)\nPlatform: x86_64-w64-mingw32/x64\nRunning under: Windows 11 x64 (build 26100)\n\nMatrix products: default\n  LAPACK version 3.12.1\n\nlocale:\n[1] LC_COLLATE=English_United States.utf8 \n[2] LC_CTYPE=English_United States.utf8   \n[3] LC_MONETARY=English_United States.utf8\n[4] LC_NUMERIC=C                          \n[5] LC_TIME=English_United States.utf8    \n\ntime zone: America/New_York\ntzcode source: internal\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] ProbBayes_1.1     shiny_1.10.0      gridExtra_2.3     LearnBayes_2.15.1\n [5] lubridate_1.9.4   forcats_1.0.0     stringr_1.5.1     dplyr_1.1.4      \n [9] purrr_1.0.4       readr_2.1.5       tidyr_1.3.1       tibble_3.2.1     \n[13] ggplot2_3.5.2     tidyverse_2.0.0  \n\nloaded via a namespace (and not attached):\n [1] generics_0.1.3    stringi_1.8.7     hms_1.1.3         digest_0.6.37    \n [5] magrittr_2.0.3    evaluate_1.0.3    grid_4.5.0        timechange_0.3.0 \n [9] fastmap_1.2.0     jsonlite_2.0.0    promises_1.3.2    scales_1.3.0     \n[13] cli_3.6.4         rlang_1.1.6       munsell_0.5.1     withr_3.0.2      \n[17] yaml_2.3.10       tools_4.5.0       tzdb_0.5.0        colorspace_2.1-1 \n[21] httpuv_1.6.16     vctrs_0.6.5       R6_2.6.1          mime_0.13        \n[25] lifecycle_1.0.4   htmlwidgets_1.6.4 pkgconfig_2.0.3   pillar_1.10.2    \n[29] later_1.4.2       gtable_0.3.6      glue_1.8.0        Rcpp_1.0.14      \n[33] xfun_0.52         tidyselect_1.2.1  knitr_1.50        farver_2.1.2     \n[37] xtable_1.8-4      htmltools_0.5.8.1 rmarkdown_2.29    labeling_0.4.3   \n[41] compiler_4.5.0   \n```\n\n\n:::\n:::\n\n",
    "supporting": [
      "13_Bayesian_inference_Beta_priors_JingchenHu_lab1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}